{%extends 'base.html'%}
{%block title%}
{{city.name}}
{%endblock%}
{%block content%}
<style>
body {
  margin:0;
  padding:0;
  display: grid;
  grid-template-columns: 1fr;
  grid-template-rows: 70px 1fr;
  min-height: 100vh;
}
main {
  display: grid;
  grid-template-columns: 1fr 2.5fr;
}

.modal-body form{
    display:grid;
}
.material-icons.md-36 { 
  font-size: 33px; 
  }
.post-create-btn{
  color:#5E6472;
}
.post-create-btn:hover {
  color:black;
}
.post-create-btn:visited {
  color:#5E6472;
}
aside {
  background:#ffa69e;
}

</style>

<body>
  <main class="mt-2">
    <aside class="container mt-2 border border-2 border-dark">
      <h1 class="pt-2 ps-3">Cities</h1>
      {% for city in cities %}
        <div class="cointainer row m-3 rounded-3">
          <div class="col-6 p-0" style="height: 100px;">
            <img  class="img-fluid mh-100 rounded m-1" style="border: 5px solid black;" src="{{city.image}}" alt="">
          </div>
          <div class="col-6">
            <a style="color: black; text-decoration: none;" href="/cities/1/ ">
              <h4 class="ps-2 pt-1" style="color: black; " >{{city.name}}</h4></a>
          </div>
        </div>
    {% endfor %}
    </aside>
    <div class="container ps-0 m-2 pe-0 border border-2 border-dark">
      <div class="container">
        <div class="row">
          <div class="col-3 ps-4">
            <h2 class="fw-bolder pt-2">{{city.name}}</h2>
            <h4>{{city.country}}</h4>
          </div>
          <div class="col-8 ps-5">
            <img class="img-fluid rounded pt-2" src="{{city.image}}" alt="{{city.name}}">
          </div>
        </div>
      </div>


      <div class="container ps-4">
        <div class="d-flex justify-content-between p-3 pb-0">
          <h3>Posts</h3>
  <!--Modal and button start-->
  <!-- Button trigger modal -->
            <a href='#' class="post-create-btn  text-decoration-none" data-bs-toggle="modal" data-bs-target="#createPostModal">
              <span class="material-icons md-36">
                add_circle_outline
              </span>
            </a>
        </div>
      </div>
  
  <!--Modal and Button End-->
      <div class="container">
        {% for post in city.posts.all %}
        <div class="row m-3 rounded-3" style="background-color:#F7EBC7;">
          <div class="col-2 p-0">
            <img class="img-fluid rounded m-1" style="border: 5px solid black;" src="{{post.users.profile.image}}" alt="">
          </div>
        <div class="col-10">
          <a style="color: black;" href="{% url "post_details" post.pk %} "><h5 style="color: black;" >{{post.title}}</h5></a>
        {% if post.content|length > 1000 %}
          <p class="half-content" id="half-{{post.id}}">{{ post.content|truncatechars:1000 }}<a data-id="{{post.id}}" href="javascript:void();" class="show-hide-btn text-decoration-none" style="color: #5e6472;"><br>Read More</a></p>
          <p class="full-content" id="full-{{post.id}}" style="display: none;">{{ post.content }}<a data-id="{{post.id}}" href="javascript:void();" class="show-hide-btn text-decoration-none" style="color: #5e6472;"><br>Read Less</a></p>
        {% else %}
          <p>{{ post.content }}</p>
        {% endif %}
        </div>
      </div>  

{% endfor %}
  </div>
</div>
<!-- Modal Post Create Start -->
<div class="modal fade" id="createPostModal" tabindex="-1" aria-labelledby="createPostModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header border-0 mb-0">
        <h2 class = "mt-2">Create Post</h2>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form action="{%url 'post_create'%}" method='POST'>
        {% csrf_token %}
        <label for="post-cities" class = "mb-1">city</label>
        <select class = "mb-3" name="cities" id="post-cities">
        {%for city in cities%}
        <option value="{{city.pk}}">{{city.name}}</option>
        {%empty%}
        <option>no cities</option>
        {%endfor%}
        </select>
        <label  class = "mb-1" for="post-title">title</label>
        <input class = "mb-3" id = "post-title" type="text" name = 'title'>
        <label class = "mb-1" for="post-content">content</label>
        <textarea class = "mb-3" name="content" id="post-content" cols="30" rows="10"></textarea>
        <input class = "mb-3 btn btn-outline-secondary" type="submit" value = "submit">
        </form>
      </div>
    </div>
  </div>
</div>
</main>
</body>
<!--modal post create end-->
<script>
$(document).ready(function() {
  $(".show-hide-btn").click(function() {
    var id = $(this).data("id");
    $("#half-" + id).toggle();//hide/show..
    $("#full-" + id).toggle();
  })
})
</script>
{%endblock%}